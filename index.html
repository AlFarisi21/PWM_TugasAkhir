<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blog Saya - Halaman Utama</title>
  <link rel="icon" type="image/png" href="logoblog(1).png" sizes="32x32">

  <!-- Bootstrap CSS untuk desain responsif -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- memanggil manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- CSS tambahan untuk styling khusus -->
  <style>
    .header-custom {
      background: linear-gradient(to right, #007bff, #6610f2);
      transition: all 0.5s ease;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .header-hidden {
      opacity: 0;
      filter: blur(5px);
      pointer-events: none;
    }

    .card-img-top {
      height: 300px;
      object-fit: cover;
    }

    .card:hover {
      transform: scale(1.02);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }

    .error {
      color: red;
      text-align: center;
      margin-top: 20px;
    }
    .loading {
      text-align: center;
      font-style: italic;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="header-custom text-white text-center py-3 shadow">
    <div class="container">
      <h1 class="display-4 fw-bold">Blog Teknologi</h1>
      <p class="lead">Berita dan artikel seputar dunia teknologi terkini</p>
    </div>
  </header>

  <!-- Konten utama -->
  <main class="container my-4">
    <div id="loading" class="loading">Memuat berita...</div>
    <div id="error" class="error"></div>
    <div class="row" id="articles"></div>
  </main>

  <!-- Footer -->
  <footer class="bg-dark text-white text-center py-3">
    <p>Â© 2025 Blog Teknologi Terbaru</p>
  </footer>

  <!-- Script -->
  <script>
    // Efek scroll pada header
    const header = document.querySelector('.header-custom');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 100) {
        header.classList.add('header-hidden');
      } else {
        header.classList.remove('header-hidden');
      }
    });

    // Daftar gambar random bertema teknologi
    const techImages = [
      'https://images.unsplash.com/photo-1516321318423-f06f85e504b3?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', // Server room
      'https://images.unsplash.com/photo-1550751827-4bd374c3f58b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', // AI circuit
      'https://images.unsplash.com/photo-1516321497487-e288fb19713f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', // Cloud computing
      'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', // Coding
      'https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', // Tech gadgets
      'https://images.unsplash.com/photo-1485827404703-89b55fcc595e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80' // Futuristic tech
    ];

    // Fungsi untuk memilih gambar random
    function getRandomTechImage() {
      return techImages[Math.floor(Math.random() * techImages.length)];
    }

    // URL API dari Mediastack API
    const url = 'http://api.mediastack.com/v1/news?access_key=e9e0969ee9dd293831691399b6180d7b&keywords=technology&categories=technology&languages=en&sort=published_desc&limit=6';

    async function fetchNews() {
      const loading = document.getElementById('loading');
      const errorDiv = document.getElementById('error');
      const articlesDiv = document.getElementById('articles');

      try {
        const response = await fetch(url);
        loading.style.display = 'none';

        if (response.ok) {
          const data = await response.json();

          if (data.data && data.data.length > 0) {
            data.data.forEach((article, index) => {
              const title = article.title || 'Tidak ada judul';
              const description = article.description || 'Tidak ada deskripsi';
              const source = article.source || 'Tidak ada sumber';
              // Gunakan gambar dari API jika tersedia, jika tidak gunakan gambar random teknologi
              const image = article.image && article.image !== null ? article.image : getRandomTechImage();
              const url = article.url || '#';

              const articleDiv = document.createElement('div');
              articleDiv.className = 'col-md-6 mb-4';
              articleDiv.innerHTML = `
                <div class="card h-100">
                  <img src="${image}" class="card-img-top" alt="Gambar ${title}">
                  <div class="card-body">
                    <h5 class="card-title">${title}</h5>
                    <p class="card-text">${description.slice(0, 150)}...</p>
                    <button class="btn btn-primary" onclick="viewDetail(${index})">Baca Selengkapnya</button>
                  </div>
                </div>
              `;
              articlesDiv.appendChild(articleDiv);

              // Menyimpan data artikel ke sessionStorage untuk detail
              sessionStorage.setItem(`article_${index}`, JSON.stringify({ ...article, image }));
            });
          } else {
            errorDiv.textContent = 'Tidak ada berita teknologi ditemukan.';
          }
        } else {
          const errorData = await response.json();
          loading.style.display = 'none';
          errorDiv.textContent = `Gagal mengambil data. Status: ${response.status}, Pesan: ${errorData.message || 'Kemungkinan API key tidak valid. Silakan periksa di mediastack.com.'}`;
        }
      } catch (error) {
        loading.style.display = 'none';
        errorDiv.textContent = `Terjadi kesalahan saat memanggil API: ${error.message}. Pastikan Anda terhubung ke internet.`;
      }
    }

    function viewDetail(index) {
      window.location.href = `detail.html?index=${index}`;
    }

    window.onload = fetchNews;
  </script>

  <!-- service worker -->
  <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js')
        .then(reg => console.log('Service worker terdaftar:', reg))
        .catch(err => console.log('Service worker gagal:', err));
    });
  }
</script>

</body>
</html>